<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
      <title>Very dumb NOSTR client</title>
  </head>
  <body>
  <button id="sendEvent1" onclick="sendEvent()">Send Event</button>
  <button id="sendEvent2" onclick="sendEvent2()">Send Event 2</button>
  <button id="sendReq1" onclick="sendReq()">Send Req</button>
  <button id="sendReq2" onclick="sendReq2()">Send Req 2</button>
  <button id="sendClose" onclick="sendClose()">Send Close</button>
  <button id="sendClose2" onclick="sendClose2()">Send Close 2</button>
  <button id="sendReq3" onclick="sendReq3()">Send Req 3</button>
  <button id="sendClose3" onclick="sendClose3()">Send Close 3</button>
  <button id="sendInvalid" onclick="sendInvalid()">Invalid</button>
  <script>

      let socket = new WebSocket('ws://localhost:8080');
      const eventData = {
          "id": "id10",
          "pubkey": "pubkey3",
          "created_at": 1632871,
          "kind": 1,
          "tags": [],
          "content": "cool content",
          "sig": "xyz"
      };
      const eventData2 = {
        "id": "id11",
        "pubkey": "pubkey2",
        "created_at": 6666666,
        "kind": 1,
        "tags": [],
        "content": "not so cool content",
        "sig": "abc"
      };
      const reqData = {
          "ids": ["id1", "id2"],
          "authors": ["pubkey2", "pubkey3"],
          "kinds": [0, 1],
          "#e": ["e2", "e3"],
          "#p": ["pubkey5", "pubkey6"],
          "since": 1642156800,
          "until": 1642243200,
          "limit": 10
      }
      const reqData2 = {
        "ids": ["id3", "id4"],
        "authors": ["pubkey1"],
        "kinds": [0, 1],
        "#e": ["e1", "e4"],
        "#p": ["pubkey2", "pubkey5"],
        "since": 1642156800,
        "until": 1642243200,
        "limit": 10
      }

      const eventMessage = JSON.stringify(["EVENT", eventData]);
      const eventMessage2 = JSON.stringify(["EVENT", eventData2]);
      const reqMessage = JSON.stringify(["REQ", "sample_sub_id", reqData]);
      const reqMessage2 = JSON.stringify(["REQ", "sample_sub_id2", reqData2]);
      const closeMessage = JSON.stringify(["CLOSE", "sample_sub_id"]);
      const closeMessage2 = JSON.stringify(["CLOSE", "sample_sub_id2"]);
      const reqMessage3 = JSON.stringify(["REQ", "sample_sub_id3", reqData, reqData2]);
      const closeMessage3 = JSON.stringify(["CLOSE", "sample_sub_id3"]);
      const invalidMessage = JSON.stringify("invalid message");

      socket.addEventListener('open', function (event) {
        console.log('WebSocket connection opened:', event);
      });

      socket.addEventListener('message', function (message) {
        console.log('Message from relay:', message.data);
      });

      socket.addEventListener('close', function (message) {
        console.log('WebSocket connection closed:', message);
      });

      function sendEvent() {
        console.log('Sending message:', eventMessage);
        socket.send(eventMessage);
      }

      function sendEvent2() {
        console.log('Sending message:', eventMessage2);
        socket.send(eventMessage2);
      }

      function sendReq() {
          console.log('Sending message:', reqMessage);
          socket.send(reqMessage);
      }

      function sendReq2() {
        console.log('Sending message:', reqMessage2);
        socket.send(reqMessage2);
      }

      function sendReq3() {
        console.log('Sending message:', reqMessage3);
        socket.send(reqMessage3);
      }

      function sendClose() {
          console.log('Sending message:', closeMessage);
          socket.send(closeMessage);
      }

      function sendClose2() {
        console.log('Sending message:', closeMessage2);
        socket.send(closeMessage2);
      }

      function sendClose3() {
        console.log('Sending message:', closeMessage3);
        socket.send(closeMessage3);
      }

      function sendInvalid() {
        console.log('Sending message:', invalidMessage);
        socket.send(invalidMessage);
      }

    </script>
  </body>
</html>